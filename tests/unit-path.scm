#!/usr/bin/guile -s
!#

;;;; Premable

(define load-path--local (string-drop-right (car (command-line)) 14))
(set! %load-path (append (list load-path--local) %load-path))

(use-modules (interactive))

;;;; Fails (comment or remove when commiting to master)

;;;; Unit definitions

;;; NOTE: this is a bottom-up test suite: it'll test single scopes, with unit
;;;   matches. Later matches redo this base test. Think of it kind of like
;;;  'counting in binary' with the tests.

;;;; day

;;; unit

;; *day

(unit-ex-fail (10 1 2100) (1 1 2100) (2 1 2100))
(unit-ex-succ (10 1 2100) (1 1 2100) (10 1 2100))
(unit-ex-succ (10 1 2100) (1 1 2100) (11 1 2100))
(unit-ex-fail (10 1 2100) (10 1 2100) (11 1 2100))
(unit-ex-fail (10 1 2100) (11 1 2100) (12 1 2100))

; path
(unit-ex-fail (10 10 2100) (31 12 2099) (9 10 2100))
(unit-ex-fail (10 10 2100) (1 1 2100) (9 10 2100))
(unit-ex-succ (10 10 2100) (31 12 2099) (10 10 2100))
(unit-ex-succ (10 10 2100) (1 1 2100) (10 10 2100))

(unit-ex-fail (10 10 2100) (10 10 2100) (1 1 2101))
(unit-ex-fail (10 10 2100) (10 10 2100) (1 11 2100))
(unit-ex-succ (10 10 2100) (9 10 2100) (1 1 2101))
(unit-ex-succ (10 10 2100) (9 10 2100) (1 11 2100))

(unit-ex-succ (10 10 2100) (31 12 2099) (1 1 2101))
(unit-ex-succ (10 10 2100) (1 1 2100) (1 1 2101))
(unit-ex-succ (10 10 2100) (31 12 2099) (11 12 2100))
(unit-ex-succ (10 10 2100) (1 1 2100) (11 12 2100))

;; wday

(unit-ex-fail (fri 9 2100) (1 9 2100) (2 9 2100))
(unit-ex-succ (fri 9 2100) (1 9 2100) (3 9 2100))
(unit-ex-succ (fri 9 2100) (1 9 2100) (7 9 2100))
(unit-ex-fail (fri 9 2100) (3 9 2100) (4 9 2100))
(unit-ex-fail (fri 9 2100) (3 9 2100) (7 9 2100))
(unit-ex-fail (fri 9 2100) (4 9 2100) (7 9 2100))

; path
(unit-ex-fail (fri 9 2100) (31 12 2099) (1 9 2100))
(unit-ex-fail (fri 9 2100) (1 1 2100) (1 9 2100))
(unit-ex-succ (fri 9 2100) (31 12 2099) (3 9 2100))
(unit-ex-succ (fri 9 2100) (1 1 2100) (3 9 2100))

(unit-ex-fail (fri 9 2100) (30 9 2100) (1 1 2101))
(unit-ex-fail (fri 9 2100) (30 9 2100) (1 10 2100))
(unit-ex-succ (fri 9 2100) (23 9 2100) (1 1 2101))
(unit-ex-succ (fri 9 2100) (23 9 2100) (1 10 2100))

(unit-ex-succ (fri 9 2100) (31 12 2099) (1 10 2101))
(unit-ex-succ (fri 9 2100) (1 7 2100) (1 10 2101))
(unit-ex-succ (fri 9 2100) (31 12 2099) (1 10 2100))
(unit-ex-succ (fri 9 2100) (1 7 2100) (1 10 2100))

;;; glob

;; *day

(unit-ex-fail (* 10 2100) (10 10 2100) (10 10 2100))
(unit-ex-succ (* 10 2100) (1 10 2100) (2 10 2100))

; path

(unit-ex-succ (* 10 2100) (1 1 2099) (1 10 2100))
(unit-ex-succ (* 10 2100) (1 9 2100) (1 10 2100))

(unit-ex-fail (* 9 2100) (30 9 2100) (1 10 2100))
(unit-ex-fail (* 9 2100) (30 9 2100) (1 1 2101))
(unit-ex-succ (* 9 2100) (29 9 2100) (1 1 2101))
(unit-ex-succ (* 9 2100) (29 9 2100) (1 10 2100))

(unit-ex-succ (* 9 2100) (31 12 2099) (1 1 2101))
(unit-ex-succ (* 9 2100) (1 1 2100) (1 1 2101))
(unit-ex-succ (* 9 2100) (31 12 2099) (11 12 2100))
(unit-ex-succ (* 9 2100) (1 1 2100) (11 12 2100))

;;; range

;; *day

(unit-ex-fail ((- 10 20 2) 10 2100) (1 10 2100) (2 10 2100))
(unit-ex-succ ((- 10 20 2) 10 2100) (1 10 2100) (10 10 2100))
(unit-ex-succ ((- 10 20 2) 10 2100) (10 10 2100) (12 10 2100))
(unit-ex-succ ((- 10 20 2) 10 2100) (10 10 2100) (14 10 2100))
(unit-ex-fail ((- 10 20 2) 10 2100) (10 10 2100) (11 10 2100))

; path
(unit-ex-fail ((- 10 20 2) 10 2100) (1 10 2099) (1 10 2100))
(unit-ex-fail ((- 10 20 2) 10 2100) (10 9 2100) (1 10 2100))
(unit-ex-succ ((- 10 20 2) 10 2100) (1 10 2099) (10 10 2100))
(unit-ex-succ ((- 10 20 2) 10 2100) (10 9 2100) (10 10 2100))

(unit-ex-fail ((- 10 20 2) 10 2100) (21 10 2100) (1 1 2101))
(unit-ex-fail ((- 10 20 2) 10 2100) (21 10 2100) (1 11 2100))
(unit-ex-succ ((- 10 20 2) 10 2100) (10 10 2100) (1 1 2101))
(unit-ex-succ ((- 10 20 2) 10 2100) (10 10 2100) (1 11 2100))

(unit-ex-succ ((- 10 20 2) 10 2100) (31 12 2099) (1 1 2101))
(unit-ex-succ ((- 10 20 2) 10 2100) (10 9 2100) (1 1 2101))
(unit-ex-succ ((- 10 20 2) 10 2100) (31 12 2099) (1 12 2100))
(unit-ex-succ ((- 10 20 2) 10 2100) (10 9 2100) (1 12 2100))

;; wday

(unit-ex-fail ((- tue fri 2) 9 2100) (5 9 2100) (6 9 2100))
(unit-ex-succ ((- tue fri 2) 9 2100) (5 9 2100) (7 9 2100))
(unit-ex-succ ((- tue fri 2) 9 2100) (7 9 2100) (9 9 2100))
(unit-ex-fail ((- tue fri 2) 9 2100) (7 9 2100) (8 9 2100))
(unit-ex-succ ((- tue fri 2) 9 2100) (10 9 2100) (14 9 2100))

; path
(unit-ex-fail ((- tue fri 2) 9 2100) (31 12 2099) (1 9 2100))
(unit-ex-fail ((- tue fri 2) 9 2100) (1 7 2100) (1 9 2100))
(unit-ex-succ ((- tue fri 2) 9 2100) (31 12 2099) (3 9 2100))
(unit-ex-succ ((- tue fri 2) 9 2100) (1 7 2100) (3 9 2100))

(unit-ex-fail ((- tue fri 2) 9 2100) (30 9 2100) (1 1 2101))
(unit-ex-fail ((- tue fri 2) 9 2100) (30 9 2100) (1 10 2100))
(unit-ex-succ ((- tue fri 2) 9 2100) (29 9 2100) (1 1 2101))
(unit-ex-succ ((- tue fri 2) 9 2100) (29 9 2100) (1 10 2100))

(unit-ex-succ ((- tue fri 2) 9 2100) (31 12 2099) (1 1 2101))
(unit-ex-succ ((- tue fri 2) 9 2100) (1 8 2100) (1 1 2101))
(unit-ex-succ ((- tue fri 2) 9 2100) (31 12 2099) (1 10 2100))
(unit-ex-succ ((- tue fri 2) 9 2100) (1 8 2099) (1 10 2100))

;;;; mon

;;; glob

;; unit *day

(unit-ex-fail (10 * 2100) (10 1 2100) (11 1 2100))
(unit-ex-fail (10 * 2100) (10 1 2100) (9 2 2100))
(unit-ex-succ (10 * 2100) (9 1 2100) (10 1 2100))
(unit-ex-succ (10 * 2100) (10 1 2100) (10 2 2100))
(unit-ex-succ (10 * 2100) (11 1 2100) (1 3 2100))

; path
(unit-ex-fail (10 * 2100) (31 12 2099) (9 1 2100))
(unit-ex-succ (10 * 2100) (31 12 2099) (10 1 2100))
(unit-ex-succ (10 * 2100) (31 12 2099) (1 2 2100))

(unit-ex-fail (10 * 2100) (10 12 2100) (1 1 2101))
(unit-ex-succ (10 * 2100) (9 12 2100) (10 1 2101))
(unit-ex-succ (10 * 2100) (1 10 2100) (1 2 2101))

(unit-ex-succ (10 * 2100) (31 12 2099) (1 1 2101))

;; unit wday

(unit-ex-fail (fri * 2100) (1 2 2100) (4 2 2100))
(unit-ex-succ (fri * 2100) (1 2 2100) (5 2 2100))
(unit-ex-fail (fri * 2100) (5 2 2100) (6 2 2100))
(unit-ex-fail (fri * 2100) (26 2 2100) (1 3 2100))
(unit-ex-succ (fri * 2100) (26 2 2100) (5 3 2100))
(unit-ex-succ (fri * 2100) (25 2 2100) (1 3 2100))

; path
(unit-ex-fail (sat * 2100) (31 12 2099) (1 1 2100))
(unit-ex-succ (sat * 2100) (31 12 2099) (1 2 2100))

(unit-ex-fail (sat * 2100) (25 12 2100) (1 1 2101))
(unit-ex-succ (sat * 2100) (24 12 2100) (1 1 2101))
(unit-ex-succ (sat * 2100) (31 11 2100) (1 1 2101))

(unit-ex-succ (sat * 2100) (1 1 2099) (1 1 2101))

;; glob *day

(unit-ex-fail (* * 2100) (1 1 2100) (1 1 2100))
(unit-ex-succ (* * 2100) (1 1 2100) (2 1 2100))

; path
(unit-ex-succ (* * 2100) (1 1 2099) (1 1 2100))
(unit-ex-succ (* * 2100) (1 1 2100) (1 1 2101))
(unit-ex-succ (* * 2100) (1 1 2099) (1 1 2101))

;; range *day

(unit-ex-fail ((- 10 20 2) * 2100) (1 1 2100) (2 1 2100))
(unit-ex-fail ((- 10 20 2) * 2100) (10 1 2100) (11 1 2100))
(unit-ex-succ ((- 10 20 2) * 2100) (1 1 2100) (10 1 2100))
(unit-ex-succ ((- 10 20 2) * 2100) (10 1 2100) (1 2 2100))
(unit-ex-fail ((- 10 20 2) * 2100) (20 1 2100) (1 2 2100))
(unit-ex-succ ((- 10 20 2) * 2100) (20 1 2100) (1 3 2100))

; path
(unit-ex-fail ((- 10 20 2) * 2100) (31 12 2099) (9 1 2100))
(unit-ex-succ ((- 10 20 2) * 2100) (31 12 2099) (10 1 2100))
(unit-ex-succ ((- 10 20 2) * 2100) (31 12 2099) (1 2 2100))

(unit-ex-fail ((- 10 20 2) * 2100) (20 12 2100) (1 1 2101))
(unit-ex-succ ((- 10 20 2) * 2100) (5 12 2100) (1 1 2101))

(unit-ex-succ ((- 10 20 2) * 2100) (1 1 2099) (1 1 2101))

;; range wday

(unit-ex-fail ((- tue sat 2) * 2100) (1 8 2100) (2 8 2100))
(unit-ex-succ ((- tue sat 2) * 2100) (1 8 2100) (3 8 2100))
(unit-ex-fail ((- tue sat 2) * 2100) (7 8 2100) (9 8 2100))
(unit-ex-succ ((- tue sat 2) * 2100) (7 8 2100) (10 8 2100))
(unit-ex-fail ((- tue sat 2) * 2100) (27 2 2100) (1 3 2100))
(unit-ex-succ ((- tue sat 2) * 2100) (27 2 2100) (2 3 2100))
(unit-ex-succ ((- tue sat 2) * 2100) (27 2 2100) (1 4 2100))

; path
(unit-ex-fail ((- tue sat 2) * 2100) (31 12 2099) (1 1 2100))
(unit-ex-succ ((- tue sat 2) * 2100) (31 12 2099) (2 1 2100))

(unit-ex-succ ((- tue sat 2) * 2100) (29 12 2100) (1 1 2101))
(unit-ex-fail ((- tue sat 2) * 2100) (30 12 2100) (1 1 2101))
(unit-ex-fail ((- tue sat 2) * 2100) (31 12 2100) (1 1 2101))
(unit-ex-succ ((- tue sat 2) * 2100) (1 11 2100) (1 1 2101))

(unit-ex-succ ((- tue sat 2) * 2100) (1 1 2099) (1 1 2101))

;;; range

;; unit *day

(unit-ex-fail (10 (- 5 10 2) 2100) (1 1 2100) (2 1 2100))
(unit-ex-fail (10 (- 5 10 2) 2100) (1 5 2100) (2 5 2100))
(unit-ex-succ (10 (- 5 10 2) 2100) (9 5 2100) (10 5 2100))
(unit-ex-succ (10 (- 5 10 2) 2100) (30 5 2100) (10 7 2100))
(unit-ex-fail (10 (- 5 10 2) 2100) (30 5 2100) (9 7 2100))

; path
(unit-ex-fail (10 (- 5 10 2) 2100) (31 12 2099) (10 1 2100))
(unit-ex-succ (10 (- 5 10 2) 2100) (31 12 2099) (10 5 2100))

(unit-ex-fail (10 (- 5 10 2) 2100) (10 9 2100) (1 1 2101))
(unit-ex-succ (10 (- 5 10 2) 2100) (9 9 2100) (1 1 2101))
(unit-ex-succ (10 (- 5 10 2) 2100) (1 1 2100) (1 1 2101))

(unit-ex-succ (10 (- 5 10 2) 2100) (1 1 2099) (1 1 2101))

;; unit wday

(unit-ex-fail (fri (- 5 10 2) 2100) (1 1 2100) (2 1 2100))
(unit-ex-fail (fri (- 5 10 2) 2100) (20 4 2100) (6 5 2100))
(unit-ex-succ (fri (- 5 10 2) 2100) (20 4 2100) (7 5 2100))
(unit-ex-fail (fri (- 5 10 2) 2100) (28 5 2100) (1 7 2100))
(unit-ex-succ (fri (- 5 10 2) 2100) (28 5 2100) (2 7 2100))
(unit-ex-fail (fri (- 5 10 2) 2100) (1 10 2100) (1 12 2100))
(unit-ex-fail (fri (- 5 10 2) 2100) (1 11 2100) (1 12 2100))

; path
(unit-ex-fail (fri (- 5 10 2) 2100) (31 12 2099) (1 1 2100))
(unit-ex-fail (fri (- 5 10 2) 2100) (31 12 2099) (6 5 2100))
(unit-ex-succ (fri (- 5 10 2) 2100) (31 12 2099) (7 5 2100))

(unit-ex-fail (fri (- 5 10 2) 2100) (1 11 2100) (1 1 2101))
(unit-ex-fail (fri (- 5 10 2) 2100) (24 9 2100) (1 1 2101))
(unit-ex-succ (fri (- 5 10 2) 2100) (23 9 2100) (1 1 2101))

(unit-ex-succ (fri (- 5 10 2) 2100) (1 1 2099) (1 1 2101))

;; glob *day

(unit-ex-fail (* (- 5 10 2) 2100) (1 1 2100) (1 2 2100))
(unit-ex-succ (* (- 5 10 2) 2100) (1 1 2100) (1 5 2100))
(unit-ex-fail (* (- 5 10 2) 2100) (1 5 2100) (1 5 2100))
(unit-ex-succ (* (- 5 10 2) 2100) (1 5 2100) (2 5 2100))
(unit-ex-fail (* (- 5 10 2) 2100) (1 10 2100) (1 11 2100))
(unit-ex-succ (* (- 5 10 2) 2100) (1 1 2100) (1 11 2100))

; path
(unit-ex-fail (* (- 5 10 2) 2100) (30 9 2100) (1 1 2101))
(unit-ex-succ (* (- 5 10 2) 2100) (31 12 2099) (1 5 2100))
(unit-ex-succ (* (- 5 10 2) 2100) (29 9 2100) (1 1 2101))
(unit-ex-succ (* (- 5 10 2) 2100) (1 1 2099) (1 1 2101))

;; range *day

(unit-ex-fail ((- 10 20 2) (- 5 10 2) 2100) (1 1 2100) (1 2 2100))
(unit-ex-fail ((- 10 20 2) (- 5 10 2) 2100) (10 5 2100) (11 5 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2) 2100) (10 5 2100) (12 5 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2) 2100) (20 5 2100) (10 7 2100))
(unit-ex-fail ((- 10 20 2) (- 5 10 2) 2100) (20 9 2100) (31 12 2100))

; path
(unit-ex-fail ((- 10 20 2) (- 5 10 2) 2100) (31 12 2099) (9 5 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2) 2100) (31 12 2099) (10 5 2100))

(unit-ex-fail ((- 10 20 2) (- 5 10 2) 2100) (20 9 2100) (1 1 2101))
(unit-ex-fail ((- 10 20 2) (- 5 10 2) 2100) (10 10 2100) (1 1 2101))
(unit-ex-succ ((- 10 20 2) (- 5 10 2) 2100) (10 9 2100) (1 1 2101))

(unit-ex-succ ((- 10 20 2) (- 5 10 2) 2100) (1 1 2099) (1 1 2101))

;; range wday

(unit-ex-fail ((- tue sat 2) (- 5 10 2) 2100) (1 1 2100) (1 2 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2) 2100) (1 1 2100) (4 5 2100))
(unit-ex-fail ((- tue sat 2) (- 5 10 2) 2100) (4 5 2100) (5 5 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2) 2100) (4 5 2100) (6 5 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2) 2100) (31 5 2100) (1 7 2100))

; path
(unit-ex-fail ((- tue sat 2) (- 5 10 2) 2100) (31 12 2099) (1 1 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2) 2100) (31 12 2099) (4 5 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2) 2100) (31 12 2099) (1 10 2100))
(unit-ex-fail ((- tue sat 2) (- 5 10 2) 2100) (31 12 2099) (3 5 2100))

(unit-ex-fail ((- tue sat 2) (- 5 10 2) 2100) (30 9 2100) (1 1 2101))
(unit-ex-fail ((- tue sat 2) (- 5 10 2) 2100) (1 10 2100) (1 1 2101))
(unit-ex-succ ((- tue sat 2) (- 5 10 2) 2100) (29 9 2100) (1 1 2101))

(unit-ex-succ ((- tue sat 2) (- 5 10 2) 2100) (1 1 2099) (1 1 2101))

;;;; year

;;; glob -- unit mon

;; unit *day

(unit-ex-fail (10 10) (1 1 2100) (1 2 2100))
(unit-ex-succ (10 10) (9 10 2100) (10 10 2100))
(unit-ex-succ (10 10) (9 10 2100) (1 11 2100))
(unit-ex-fail (10 10) (10 10 2100) (1 11 2100))

; path
(unit-ex-fail (10 10) (31 12 2099) (1 1 2100))
(unit-ex-succ (10 10) (31 12 2099) (10 10 2100))

(unit-ex-fail (10 10) (10 10 2100) (1 1 2101))
(unit-ex-fail (10 10) (1 11 2100) (1 1 2101))
(unit-ex-succ (10 10) (1 1 2100) (1 1 2101))
(unit-ex-succ (10 10) (1 11 2100) (10 10 2101))
(unit-ex-succ (10 10) (1 11 2100) (1 11 2101))

(unit-ex-succ (10 10) (1 1 2099) (1 1 2101))
(unit-ex-succ (10 10) (1 11 2099) (1 1 2101))

;; unit wday

(unit-ex-fail (tue 10) (1 1 2100) (1 2 2100))
(unit-ex-succ (tue 10) (4 10 2100) (5 10 2100))
(unit-ex-fail (tue 10) (5 10 2100) (6 10 2100))
(unit-ex-succ (tue 10) (23 10 2100) (1 11 2100))

; path
(unit-ex-fail (tue 10) (31 12 2099) (1 1 2100))
(unit-ex-succ (tue 10) (26 10 2099) (1 1 2100))
(unit-ex-succ (tue 10) (27 10 2099) (5 10 2100))

(unit-ex-fail (tue 10) (31 12 2100) (1 1 2101))
(unit-ex-succ (tue 10) (23 10 2100) (1 1 2101))
(unit-ex-fail (tue 10) (26 10 2100) (1 1 2101))
(unit-ex-succ (tue 10) (26 10 2100) (4 10 2101))

(unit-ex-succ (tue 10) (1 1 2099) (1 1 2101))

;; glob *day

(unit-ex-fail (* 10) (1 9 2100) (2 9 2100))
(unit-ex-succ (* 10) (30 9 2100) (1 10 2100))

; path
(unit-ex-succ (* 10) (30 10 2099) (1 1 2100))
(unit-ex-fail (* 10) (31 10 2099) (1 1 2100))
(unit-ex-succ (* 10) (31 10 2099) (1 10 2100))

(unit-ex-fail (* 10) (31 10 2100) (1 1 2101))
(unit-ex-succ (* 10) (31 10 2100) (1 10 2101))
(unit-ex-succ (* 10) (30 10 2100) (1 1 2101))

(unit-ex-succ (* 10) (1 1 2099) (1 1 2101))

;; range *day

(unit-ex-fail ((- 10 20 2) 10) (1 1 2100) (1 2 2100))
(unit-ex-succ ((- 10 20 2) 10) (9 10 2100) (10 10 2100))
(unit-ex-fail ((- 10 20 2) 10) (20 10 2100) (1 11 2100))
(unit-ex-succ ((- 10 20 2) 10) (1 9 2100) (1 11 2100))

; path
(unit-ex-succ ((- 10 20 2) 10) (1 1 2099) (1 1 2100))
(unit-ex-fail ((- 10 20 2) 10) (20 10 2099) (1 1 2100))
(unit-ex-succ ((- 10 20 2) 10) (20 10 2099) (10 10 2100))

(unit-ex-succ ((- 10 20 2) 10) (1 1 2100) (1 1 2101))
(unit-ex-fail ((- 10 20 2) 10) (20 10 2100) (1 1 2101))
(unit-ex-succ ((- 10 20 2) 10) (20 10 2100) (10 10 2101))

(unit-ex-succ ((- 10 20 2) 10) (1 1 2099) (1 1 2101))

;; range wday

(unit-ex-fail ((- tue sat 2) 10) (1 1 2100) (1 2 2100))
(unit-ex-succ ((- tue sat 2) 10) (1 10 2100) (5 10 2100))
(unit-ex-succ ((- tue sat 2) 10) (28 10 2100) (1 11 2100))
(unit-ex-succ ((- tue sat 2) 10) (1 9 2100) (1 11 2100))

; path
(unit-ex-fail ((- tue sat 2) 10) (31 12 2099) (1 1 2100))
(unit-ex-succ ((- tue sat 2) 10) (31 12 2099) (1 11 2100))
(unit-ex-succ ((- tue sat 2) 10) (31 12 2099) (28 10 2100))

(unit-ex-fail ((- tue sat 2) 10) (1 11 2100) (1 1 2101))
(unit-ex-succ ((- tue sat 2) 10) (1 10 2100) (1 1 2101))

(unit-ex-succ ((- tue sat 2) 10) (28 10 2100) (1 11 2101))

;;; glob -- glob mon

;; unit *day

(unit-ex-fail (10 *) (1 1 2100) (2 1 2100))
(unit-ex-succ (10 *) (1 1 2100) (1 2 2100))
(unit-ex-fail (10 *) (10 1 2100) (1 2 2100))
(unit-ex-succ (10 *) (10 1 2100) (1 3 2100))

; path
(unit-ex-fail (10 *) (31 12 2099) (1 1 2100))
(unit-ex-succ (10 *) (31 12 2099) (10 1 2100))
(unit-ex-succ (10 *) (31 12 2099) (1 2 2100))
(unit-ex-succ (10 *) (1 12 2099) (1 1 2100))

(unit-ex-fail (10 *) (31 12 2100) (1 1 2101))
(unit-ex-succ (10 *) (1 12 2100) (1 1 2101))
(unit-ex-succ (10 *) (31 12 2100) (10 1 2101))
(unit-ex-succ (10 *) (31 12 2100) (1 2 2101))

(unit-ex-succ (10 *) (1 1 2099) (1 1 2101))

;; unit wday

(unit-ex-fail (tue *) (1 1 2100) (2 1 2100))
(unit-ex-succ (tue *) (1 1 2100) (5 1 2100))
(unit-ex-fail (tue *) (26 1 2100) (1 2 2100))
(unit-ex-succ (tue *) (26 1 2100) (1 3 2100))

; path
(unit-ex-fail (tue *) (31 12 2099) (1 1 2100))
(unit-ex-succ (tue *) (31 12 2099) (5 1 2100))
(unit-ex-succ (tue *) (31 12 2099) (1 2 2100))
(unit-ex-succ (tue *) (1 12 2099) (1 1 2100))

(unit-ex-fail (tue *) (31 12 2100) (1 1 2101))
(unit-ex-succ (tue *) (27 12 2100) (1 1 2101))
(unit-ex-succ (tue *) (1 12 2100) (1 1 2101))
(unit-ex-fail (tue *) (28 12 2100) (1 1 2101))
(unit-ex-fail (tue *) (31 12 2100) (1 1 2101))

(unit-ex-succ (tue *) (1 1 2099) (1 1 2101))

;; glob *day

(unit-ex-fail (* *) (1 1 2100) (1 1 2100))
(unit-ex-succ (* *) (1 1 2100) (2 1 2100))
(unit-ex-succ (* *) (1 1 2100) (1 2 2100))
(unit-ex-succ (* *) (1 1 2100) (1 1 2101))

;; range *day

(unit-ex-fail ((- 10 20 2) *) (1 1 2100) (2 1 2100))
(unit-ex-succ ((- 10 20 2) *) (1 1 2100) (10 2 2100))
(unit-ex-fail ((- 10 20 2) *) (10 1 2100) (11 1 2100))
(unit-ex-fail ((- 10 20 2) *) (20 1 2100) (1 2 2100))
(unit-ex-succ ((- 10 20 2) *) (1 1 2100) (1 3 2100))

; path
(unit-ex-fail ((- 10 20 2) *) (31 12 2099) (1 1 2100))
(unit-ex-succ ((- 10 20 2) *) (31 12 2099) (10 1 2100))
(unit-ex-succ ((- 10 20 2) *) (1 12 2099) (1 1 2100))
(unit-ex-fail ((- 10 20 2) *) (20 12 2099) (1 1 2100))

(unit-ex-fail ((- 10 20 2) *) (31 12 2100) (1 1 2101))
(unit-ex-succ ((- 10 20 2) *) (10 12 2100) (1 1 2101))
(unit-ex-succ ((- 10 20 2) *) (20 12 2100) (10 1 2101))
(unit-ex-fail ((- 10 20 2) *) (20 12 2100) (1 1 2101))

(unit-ex-succ ((- 10 20 2) *) (31 12 2099) (1 1 2101))

;; range wday

(unit-ex-succ ((- tue sat 2) *) (1 1 2100) (2 1 2100))
(unit-ex-succ ((- tue sat 2) *) (1 1 2100) (5 1 2100))
(unit-ex-fail ((- tue sat 2) *) (30 1 2100) (1 2 2100))
(unit-ex-succ ((- tue sat 2) *) (28 1 2100) (2 2 2100))

; path
(unit-ex-fail ((- tue sat 2) *) (31 12 2100) (1 1 2101))
(unit-ex-succ ((- tue sat 2) *) (31 12 2100) (4 1 2101))
(unit-ex-succ ((- tue sat 2) *) (29 12 2100) (1 1 2101))

(unit-ex-fail ((- tue sat 2) *) (31 12 2099) (1 1 2100))
(unit-ex-succ ((- tue sat 2) *) (31 12 2099) (5 1 2100))

(unit-ex-succ ((- tue sat 2) *) (31 12 2099) (1 1 2101))

;;; glob -- range mon

;; unit *day

(unit-ex-fail (10 (- 5 10 2)) (1 1 2100) (1 2 2100))
(unit-ex-fail (10 (- 5 10 2)) (10 5 2100) (11 5 2100))
(unit-ex-fail (10 (- 5 10 2)) (10 9 2100) (1 11 2100))
(unit-ex-succ (10 (- 5 10 2)) (1 9 2100) (1 11 2100))
(unit-ex-succ (10 (- 5 10 2)) (10 5 2100) (1 11 2100))

; path
(unit-ex-fail (10 (- 5 10 2)) (31 12 2099) (1 1 2100))
(unit-ex-succ (10 (- 5 10 2)) (31 12 2099) (10 5 2100))
(unit-ex-succ (10 (- 5 10 2)) (10 8 2099) (1 1 2100))

(unit-ex-fail (10 (- 5 10 2)) (31 12 2100) (1 1 2101))
(unit-ex-succ (10 (- 5 10 2)) (1 9 2100) (1 1 2101))
(unit-ex-succ (10 (- 5 10 2)) (31 12 2100) (10 5 2101))

(unit-ex-succ (10 (- 5 10 2)) (31 12 2099) (1 1 2101))

;; unit wday

(unit-ex-fail (tue (- 5 10 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ (tue (- 5 10 2)) (1 1 2100) (4 5 2100))
(unit-ex-fail (tue (- 5 10 2)) (28 5 2100) (1 6 2100))
(unit-ex-fail (tue (- 5 10 2)) (28 5 2100) (1 7 2100))
(unit-ex-succ (tue (- 5 10 2)) (28 5 2100) (6 7 2100))

; path
(unit-ex-fail (tue (- 5 10 2)) (31 12 2100) (1 1 2101))
(unit-ex-succ (tue (- 5 10 2)) (27 9 2100) (1 1 2101))
(unit-ex-succ (tue (- 5 10 2)) (1 5 2100) (1 1 2101))

(unit-ex-fail (tue (- 5 10 2)) (31 12 2099) (1 1 2100))
(unit-ex-fail (tue (- 5 10 2)) (27 10 2099) (1 1 2100))

(unit-ex-succ (tue (- 5 10 2)) (31 12 2099) (1 1 2101))

;; glob *day

(unit-ex-fail (* (- 5 10 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ (* (- 5 10 2)) (1 5 2100) (2 5 2100))
(unit-ex-fail (* (- 5 10 2)) (31 5 2100) (1 6 2100))
(unit-ex-succ (* (- 5 10 2)) (31 5 2100) (1 7 2100))

; path
(unit-ex-fail (* (- 5 10 2)) (31 12 2099) (1 1 2100))
(unit-ex-fail (* (- 5 10 2)) (31 10 2099) (1 1 2100))
(unit-ex-fail (* (- 5 10 2)) (30 9 2099) (1 1 2100))
(unit-ex-succ (* (- 5 10 2)) (29 9 2099) (1 1 2100))

(unit-ex-fail (* (- 5 10 2)) (31 12 2100) (1 1 2101))
(unit-ex-succ (* (- 5 10 2)) (31 12 2100) (1 5 2101))
(unit-ex-succ (* (- 5 10 2)) (31 10 2100) (1 5 2101))

(unit-ex-succ (* (- 5 10 2)) (31 12 2099) (1 1 2101))

;; range *day

(unit-ex-fail ((- 10 20 2) (- 5 10 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2)) (9 5 2100) (10 5 2100))
(unit-ex-fail ((- 10 20 2) (- 5 10 2)) (20 5 2100) (9 7 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2)) (20 5 2100) (10 7 2100))

; path
(unit-ex-fail ((- 10 20 2) (- 5 10 2)) (31 12 2099) (1 1 2100))
(unit-ex-fail ((- 10 20 2) (- 5 10 2)) (15 10 2099) (1 1 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2)) (15 9 2099) (1 1 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2)) (31 12 2099) (10 5 2100))

(unit-ex-fail ((- 10 20 2) (- 5 10 2)) (31 12 2100) (1 1 2101))
(unit-ex-fail ((- 10 20 2) (- 5 10 2)) (15 10 2100) (1 1 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2)) (15 9 2100) (1 1 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2)) (31 12 2100) (10 5 2101))

(unit-ex-succ ((- 10 20 2) (- 5 10 2)) (31 12 2099) (1 1 2101))

;; range wday

(unit-ex-fail ((- tue sat 2) (- 5 10 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2)) (3 5 2100) (4 5 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2)) (27 5 2100) (1 6 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2)) (27 5 2100) (1 6 2100))
(unit-ex-fail ((- tue sat 2) (- 5 10 2)) (29 10 2100) (1 11 2100))

; path
(unit-ex-fail ((- tue sat 2) (- 5 10 2)) (31 12 2099) (1 1 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2)) (31 12 2099) (4 5 2100))

(unit-ex-fail ((- tue sat 2) (- 5 10 2)) (31 12 2100) (1 1 2101))
(unit-ex-fail ((- tue sat 2) (- 5 10 2)) (27 10 2100) (1 1 2101))
(unit-ex-fail ((- tue sat 2) (- 5 10 2)) (30 9 2100) (1 1 2101))
(unit-ex-succ ((- tue sat 2) (- 5 10 2)) (29 9 2100) (1 1 2101))

(unit-ex-succ ((- tue sat 2) (- 5 10 2)) (31 12 2099) (1 1 2101))

;;; range -- unit mon

;; unit *day

(unit-ex-fail (10 10 (- 2100 2110 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ (10 10 (- 2100 2110 2)) (9 10 2100) (10 10 2100))
(unit-ex-fail (10 10 (- 2100 2110 2)) (10 10 2100) (1 1 2102))
(unit-ex-succ (10 10 (- 2100 2110 2)) (10 10 2100) (10 10 2102))

; path
(unit-ex-succ (10 10 (- 2100 2110 2)) (30 9 2100) (1 1 2101))
(unit-ex-fail (10 10 (- 2100 2110 2)) (10 10 2100) (1 1 2101))
(unit-ex-succ (10 10 (- 2100 2110 2)) (1 1 2101) (1 1 2103))

;; unit wday

(unit-ex-fail (tue 10 (- 2100 2110 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ (tue 10 (- 2100 2110 2)) (4 10 2100) (5 10 2100))
(unit-ex-succ (tue 10 (- 2100 2110 2)) (26 10 2100) (1 11 2102))
(unit-ex-fail (tue 10 (- 2100 2110 2)) (26 10 2100) (31 12 2101))

; path
(unit-ex-succ (tue 10 (- 2100 2110 2)) (4 10 2100) (5 10 2100))
(unit-ex-fail (tue 10 (- 2100 2110 2)) (1 11 2100) (1 1 2102))
(unit-ex-succ (tue 10 (- 2100 2110 2)) (31 12 2099) (1 1 2101))

;; glob *day

(unit-ex-fail (* 10 (- 2100 2110 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ (* 10 (- 2100 2110 2)) (1 9 2100) (1 10 2100))
(unit-ex-fail (* 10 (- 2100 2110 2)) (31 10 2100) (1 1 2101))
(unit-ex-succ (* 10 (- 2100 2110 2)) (31 10 2100) (1 1 2103))

; path
(unit-ex-succ (* 10 (- 2100 2110 2)) (31 12 2099) (1 1 2101))
(unit-ex-fail (* 10 (- 2100 2110 2)) (31 12 2099) (1 1 2100))
(unit-ex-succ (* 10 (- 2100 2110 2)) (31 12 2109) (1 1 2111))

;; range *day

(unit-ex-fail ((- 10 20 2) 10 (- 2100 2110 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ ((- 10 20 2) 10 (- 2100 2110 2)) (30 9 2100) (10 10 2100))
(unit-ex-succ ((- 10 20 2) 10 (- 2100 2110 2)) (30 12 2100) (20 10 2102))
(unit-ex-fail ((- 10 20 2) 10 (- 2100 2110 2)) (20 10 2100) (1 1 2102))

; path
(unit-ex-succ ((- 10 20 2) 10 (- 2100 2110 2)) (31 12 2099) (20 10 2101))
(unit-ex-fail ((- 10 20 2) 10 (- 2100 2110 2)) (31 12 2099) (1 1 2100))

;; range wday

(unit-ex-fail ((- tue sat 2) 10 (- 2100 2110 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ ((- tue sat 2) 10 (- 2100 2110 2)) (30 9 2100) (5 10 2100))
(unit-ex-fail ((- tue sat 2) 10 (- 2100 2110 2)) (30 10 2100) (1 1 2101))
(unit-ex-succ ((- tue sat 2) 10 (- 2100 2110 2)) (28 10 2100) (1 1 2103))

; path
(unit-ex-succ ((- tue sat 2) 10 (- 2100 2110 2)) (31 12 2099) (1 1 2101))

;;; range -- glob mon

;; unit *day

(unit-ex-fail (10 * (- 2100 2110 2)) (1 1 2100) (2 1 2100))
(unit-ex-succ (10 * (- 2100 2110 2)) (1 1 2100) (10 1 2100))
(unit-ex-fail (10 * (- 2100 2110 2)) (10 1 2100) (1 2 2100))
(unit-ex-succ (10 * (- 2100 2110 2)) (31 12 2100) (1 1 2103))
(unit-ex-fail (10 * (- 2100 2110 2)) (31 12 2100) (1 1 2102))

; path
(unit-ex-fail (10 * (- 2100 2110 2)) (31 12 2099) (1 1 2100))
(unit-ex-succ (10 * (- 2100 2110 2)) (31 12 2099) (1 2 2100))

;; unit wday

(unit-ex-fail (tue * (- 2100 2110 2)) (1 1 2100) (2 1 2100))
(unit-ex-succ (tue * (- 2100 2110 2)) (1 1 2100) (5 1 2100))
(unit-ex-fail (tue * (- 2100 2110 2)) (31 12 2100) (1 1 2101))
(unit-ex-succ (tue * (- 2100 2110 2)) (31 12 2100) (1 1 2103))

; path
(unit-ex-fail (tue * (- 2100 2110 2)) (31 12 2099) (1 1 2100))

;; glob *day

(unit-ex-fail (* * (- 2100 2110 2)) (1 1 2100) (1 1 2100))
(unit-ex-succ (* * (- 2100 2110 2)) (1 1 2100) (2 1 2100))
(unit-ex-fail (* * (- 2100 2110 2)) (31 12 2100) (1 1 2101))
(unit-ex-succ (* * (- 2100 2110 2)) (31 12 2101) (1 1 2102))

;; range *day

(unit-ex-fail ((- 10 20 2) * (- 2100 2110 2)) (1 1 2100) (2 1 2100))
(unit-ex-succ ((- 10 20 2) * (- 2100 2110 2)) (1 1 2100) (11 1 2100))
(unit-ex-succ ((- 10 20 2) * (- 2100 2110 2)) (11 1 2100) (9 2 2100))
(unit-ex-fail ((- 10 20 2) * (- 2100 2110 2)) (11 1 2100) (9 1 2100))
(unit-ex-fail ((- 10 20 2) * (- 2100 2110 2)) (31 12 2100) (1 1 2102))
(unit-ex-succ ((- 10 20 2) * (- 2100 2110 2)) (31 12 2100) (1 2 2102))

; path
(unit-ex-succ ((- 10 20 2) * (- 2100 2110 2)) (31 12 2099) (1 2 2100))

;; range wday

(unit-ex-succ ((- tue sat 2) * (- 2100 2110 2)) (1 1 2100) (2 1 2100))
(unit-ex-fail ((- tue sat 2) * (- 2100 2110 2)) (2 1 2100) (3 1 2100))
(unit-ex-succ ((- tue sat 2) * (- 2100 2110 2)) (1 1 2100) (1 2 2100))
(unit-ex-fail ((- tue sat 2) * (- 2100 2110 2)) (30 1 2100) (1 2 2100))
(unit-ex-succ ((- tue sat 2) * (- 2100 2110 2)) (31 12 2100) (1 2 2102))

; path

(unit-ex-succ ((- tue sat 2) * (- 2100 2110 2)) (31 12 2099) (1 5 2100))

;;; range -- range mon

;; unit *day

(unit-ex-fail (10 (- 5 10 2) (- 2100 2110 2)) (1 1 2100) (1 2 2100))
(unit-ex-succ (10 (- 5 10 2) (- 2100 2110 2)) (1 1 2100) (10 5 2100))
(unit-ex-fail (10 (- 5 10 2) (- 2100 2110 2)) (30 5 2100) (1 7 2100))
(unit-ex-succ (10 (- 5 10 2) (- 2100 2110 2)) (30 5 2100) (10 7 2100))
(unit-ex-succ (10 (- 5 10 2) (- 2100 2110 2)) (31 12 2101) (10 5 2102))
(unit-ex-succ (10 (- 5 10 2) (- 2100 2110 2)) (31 12 2101) (1 1 2103))

; path
(unit-ex-fail (10 (- 5 10 2) (- 2100 2110 2)) (31 12 2099) (1 1 2100))
(unit-ex-succ (10 (- 5 10 2) (- 2100 2110 2)) (31 12 2099) (5 10 2100))
(unit-ex-succ (10 (- 5 10 2) (- 2100 2110 2)) (31 12 2100) (1 1 2103))

;; unit wday

(unit-ex-fail (tue (- 5 10 2) (- 2100 2110 2)) (1 1 2100) (2 1 2100))
(unit-ex-fail (tue (- 5 10 2) (- 2100 2110 2)) (25 5 2100) (1 6 2100))
(unit-ex-succ (tue (- 5 10 2) (- 2100 2110 2)) (24 5 2100) (1 6 2100))
(unit-ex-succ (tue (- 5 10 2) (- 2100 2110 2)) (25 5 2100) (1 9 2100))
(unit-ex-succ (tue (- 5 10 2) (- 2100 2110 2)) (31 12 2100) (1 1 2103))

; path
(unit-ex-fail (tue (- 5 10 2) (- 2100 2110 2)) (31 12 2099) (1 1 2100))
(unit-ex-fail (tue (- 5 10 2) (- 2100 2110 2)) (31 12 2099) (1 5 2100))
(unit-ex-succ (tue (- 5 10 2) (- 2100 2110 2)) (31 12 2099) (4 5 2100))
(unit-ex-succ (tue (- 5 10 2) (- 2100 2110 2)) (31 12 2101) (1 1 2103))

;; glob *day

(unit-ex-fail (* (- 5 10 2) (- 2100 2110 2)) (1 1 2100) (2 1 2100))
(unit-ex-succ (* (- 5 10 2) (- 2100 2110 2)) (1 1 2100) (1 5 2100))

;; range *day

(unit-ex-fail ((- 10 20 2) (- 5 10 2) (- 2100 2110 2)) (10 7 2100) (11 7 2100))
(unit-ex-succ ((- 10 20 2) (- 5 10 2) (- 2100 2110 2)) (10 7 2100) (12 7 2100))

;; range wday

(unit-ex-fail ((- tue sat 2) (- 5 10 2) (- 2100 2110 2)) (1 5 2100) (2 5 2100))
(unit-ex-succ ((- tue sat 2) (- 5 10 2) (- 2100 2110 2)) (1 5 2100) (4 5 2100))

;;;; Final Log

(unit-log-end)
